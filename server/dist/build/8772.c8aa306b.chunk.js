"use strict";(self.webpackChunkserver=self.webpackChunkserver||[]).push([[8772],{14459:(j,L,n)=>{n.d(L,{M:()=>R});var f=n(96540),E=n(91616),A=n(5556),v=n.n(A),K=n(34297);function F(M,C,h){if(!M||!C)return{display:"none"};const{x:P,y:U}=h;return{transform:`translate(${P}px, ${U}px)`}}function R({renderItem:M}){const{itemType:C,isDragging:h,item:P,initialOffset:U,currentOffset:B,mouseOffset:z}=(0,K.useDragLayer)(O=>({item:O.getItem(),itemType:O.getItemType(),initialOffset:O.getInitialSourceClientOffset(),currentOffset:O.getSourceClientOffset(),isDragging:O.isDragging(),mouseOffset:O.getClientOffset()}));return h?f.createElement(E.a,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},f.createElement(E.a,{style:F(U,B,z)},M({type:C,item:P}))):null}R.propTypes={renderItem:v().func.isRequired}},96953:(j,L,n)=>{var f=n(96540);const E=(0,f.createContext)();var A=null},99142:(j,L,n)=>{n.d(L,{PO:()=>K,gY:()=>F.g,Rr:()=>ae,td:()=>w,mT:()=>se,NQ:()=>de,Jz:()=>o});var f=n(96540),E=n(69733),A=n(16391);const K=()=>{const e=(0,E.d4)(A.A),s=(0,f.useCallback)(t=>e?.components?.[t]??{},[e]);return{...e,getComponentLayout:s}};var F=n(46057),R=n(78320),M=n(96275),C=n(96046),h=n(41261);const P={error:null,isLoading:!0,layout:{},layouts:{}},B=(e,s)=>(0,h.Ay)(e,t=>{switch(s.type){case"GET_DATA":{t.isLoading=!0,t.error=null,t.layout={};break}case"GET_DATA_SUCCEEDED":{const i=s.data.contentType.uid;t.layout=s.data,t.layouts[i]=s.data,t.isLoading=!1;break}case"GET_DATA_ERROR":{t.isLoading=!1,t.error=s.error;break}case"SET_LAYOUT_FROM_STATE":{t.error=null,t.layout=e.layouts[s.uid];break}case"UPDATE_LAYOUT":{const i=e.layout;t.layout={...i,contentType:{uid:i.contentType.uid,...s.newLayout.contentType}},t.layouts[i.contentType.uid]={...i,contentType:{uid:i.contentType.uid,...s.newLayout.contentType}};break}default:return t}});var z=n(88055),O=n.n(z),q=n(58156),W=n.n(q),oe=n(63560),I=n.n(oe),_=n(98342);const Q=(e,s)=>s.find(t=>t.uid===e),ie=(e,s)=>{const t=ee(e,s),i=k(t.contentType,s),m=te(t.contentType,t.components);return I()(t,["contentType","layouts","edit"],i),I()(t,["contentType","layouts","list"],m),Object.keys(t.components).forEach(c=>{const p=k(t.components[c],s);I()(t,["components",c,"layouts","edit"],p)}),t},ee=(e,s)=>{const t=(0,_.wX)(O()(e),s,"contentType"),{components:i,contentType:m}=t,c=p=>Object.keys(p.metadatas).reduce((y,b)=>{const S=W()(p,["attributes",b],{});let x=p.metadatas[b];if(S.type==="relation"){const ye=Q(S.targetModel,s),N=x.edit.mainField,V={name:N,schema:W()(ye,["attributes",N])};x={list:{...x.list,mainField:V},edit:{...x.edit,mainField:V}}}return y[b]=x,y},{});return I()(t,["contentType","metadatas"],c(m)),Object.keys(i).forEach(p=>{const y=i[p],b=c(y);I()(t,["components",p,"metadatas"],b)}),t},k=(e,s)=>e.layouts.edit.reduce((t,i)=>{const m=i.map(c=>{const p=W()(e,["attributes",c.name],{}),y={...c,fieldSchema:p,metadatas:W()(e,["metadatas",c.name,"edit"],{})};if(p.type==="relation"){const S=Q(p.targetModel,s).pluginOptions||{};I()(y,"targetModelPluginOptions",S),I()(y,"queryInfos",{shouldDisplayRelationLink:$(e,c.name,s)})}return y});return t.push(m),t},[]),te=(e,s)=>e.layouts.list.reduce((i,m)=>{const c=W()(e,["attributes",m],{}),p=W()(e,["metadatas",m,"list"],{}),y=c.type;if(y==="relation")return i.push({key:`__${m}_key__`,name:m,fieldSchema:c,metadatas:p}),i;if(y==="component"){const b=s[c.component],S=b.settings.mainField,x=b.attributes[S];return i.push({key:`__${m}_key__`,name:m,fieldSchema:c,metadatas:{...p,mainField:{...x,name:S}}}),i}return i.push({key:`__${m}_key__`,name:m,fieldSchema:c,metadatas:p}),i},[]),$=(e,s,t)=>{const i=W()(e,["attributes",s,"targetModel"],"");return Y(t).includes(i)},Y=e=>e.filter(s=>s.isDisplayed).map(({uid:s})=>s),Z=ie,ae=e=>{const[{error:s,isLoading:t,layout:i,layouts:m},c]=(0,f.useReducer)(B,P),p=(0,f.useMemo)(C.O8,[]),{schemas:y}=(0,E.d4)(N=>p(N),E.bN),b=(0,f.useRef)(!0),{get:S}=(0,R.ry)(),x=(0,f.useCallback)(async(N,V)=>{if(m[N]){c({type:"SET_LAYOUT_FROM_STATE",uid:N});return}c({type:"GET_DATA"});try{const{data:{data:re}}=await S(`/content-manager/content-types/${N}/configuration`,{cancelToken:V.token});c({type:"GET_DATA_SUCCEEDED",data:Z(re,y)})}catch(re){if(M.A.isCancel(re))return;b.current&&console.error(re),b.current&&c({type:"GET_DATA_ERROR",error:re})}},[m,y,S]);(0,f.useEffect)(()=>()=>{b.current=!1},[]),(0,f.useEffect)(()=>{const V=M.A.CancelToken.source();return x(e,V),()=>{V.cancel("Operation canceled by the user.")}},[e,x]);const ye=(0,f.useCallback)(N=>{c({type:"UPDATE_LAYOUT",newLayout:Z(N,y)})},[y]);return{error:s,isLoading:t,layout:i,updateLayout:ye}},ge=e=>e["content-manager_app"].collectionTypeLinks;var le=n(23805),T=n.n(le),J=n(55373);const ue=(e,s)=>Object.keys(e).reduce((t,i)=>{const m=e[i],c=W()(s,[i],m);return T()(m)?{...t,[i]:ue(m,c)}:(t[i]=c,t)},{}),ce=(e,s,t)=>{const i=e.find(({to:x})=>x.includes(s));if(!i)return"/";const{to:m,search:c}=i,p=(0,J.parse)(c),y=(0,J.parse)(t.substring(1)),b=ue(p,y);return`${m}?${(0,J.stringify)(b,{encode:!1})}`},w=e=>{const[{rawQuery:s}]=(0,R.sq)(),t=(0,E.d4)(ge);return ce(t,e,s)};var Te=n(74814),X=n(56347);const se=()=>{const{search:e}=(0,X.zy)(),s=e?(0,J.parse)(e.substring(1)):{};return s.plugins?(0,J.stringify)({plugins:s.plugins},{encode:!1}):""},de=e=>{const s=(0,f.useRef)();return(0,f.useEffect)(()=>{s.current=e},[e]),s.current};var H=n(53626);const me=(e,s,t)=>({type:H.w,permissions:e,__meta__:{plugins:s,containerName:t}}),fe=()=>({type:H.p}),r=e=>e["content-manager_rbacManager"].permissions,u=e=>e.rbacProvider.collectionTypesRelatedPermissions,o=(e,s,t="listView")=>{const i=(0,E.wA)(),m=(0,E.d4)(u),c=(0,E.d4)(r),p=m[s];(0,f.useEffect)(()=>p?(i(me(p,e?e.plugins:null,t)),()=>{i(fe())}):()=>{},[p,i,e,t]);const y=c?.some(b=>b.subject!==s)??!0;return{isValid:c&&!y,permissions:c}};var d=n(96953);const g=()=>useContext(WysiwygContext),l=null},46057:(j,L,n)=>{n.d(L,{g:()=>K});var f=n(96540),E=n(34297),A=n.n(E),v=n(74814);const K=(F,{type:R="STRAPI_DND",index:M,item:C={},onStart:h,onEnd:P,onGrabItem:U,onDropItem:B,onCancel:z,onMoveItem:O,dropSensitivity:q="regular"})=>{const W=(0,f.useRef)(null),[{handlerId:oe},I]=(0,E.useDrop)({accept:R,collect(k){return{handlerId:k.getHandlerId()}},hover(k,te){if(!W.current)return;const $=k.index,Y=M;if($!==Y){if(q==="regular"){const Z=W.current.getBoundingClientRect(),ne=(Z.bottom-Z.top)/2,G=te.getClientOffset().y-Z.top;if($<Y&&G<ne||$>Y&&G>ne)return}O(Y,$),k.index=Y}}}),[{isDragging:_},Q,ie]=(0,E.useDrag)({type:R,item(){h&&h();const{width:k}=W.current?.getBoundingClientRect()??{};return{index:M,width:k,...C}},end(){P&&P()},canDrag:F,isDragging:C.id?k=>C.id===k.getItem().id:void 0,collect:k=>({isDragging:k.isDragging()})}),ee=(0,v.$)(F,M,{onGrabItem:U,onDropItem:B,onCancel:z,onMoveItem:O});return[{handlerId:oe,isDragging:_,handleKeyDown:ee},W,I,Q,ie]}},74814:(j,L,n)=>{n.d(L,{$:()=>E});var f=n(96540);const E=(A,v,{onCancel:K,onDropItem:F,onGrabItem:R,onMoveItem:M})=>{const[C,h]=(0,f.useState)(!1),P=O=>{C&&(O==="UP"?M(v-1,v):O==="DOWN"&&M(v+1,v))},U=()=>{C?(F&&F(v),h(!1)):(R&&R(v),h(!0))},B=()=>{C&&(h(!1),K&&K(v))};return O=>{if(A&&!(O.key==="Tab"&&!C))switch(O.preventDefault(),O.key){case" ":case"Enter":U();break;case"Escape":B();break;case"ArrowDown":case"ArrowRight":P("DOWN");break;case"ArrowUp":case"ArrowLeft":P("UP");break;default:}}}},96046:(j,L,n)=>{n.d(L,{LJ:()=>F,O8:()=>R,Xc:()=>M,_I:()=>A});var f=n(22325),E=n(77828);const A=()=>h=>h["content-manager_app"]||E.u,v=()=>createSelector(A(),h=>h),K=()=>createSelector(A(),h=>h.models),F=()=>(0,f.Mz)(A(),h=>({collectionTypeLinks:h.collectionTypeLinks,singleTypeLinks:h.singleTypeLinks})),R=()=>(0,f.Mz)(A(),({components:h,models:P})=>({schemas:[...h,...P]})),M=(0,f.Mz)(A(),h=>h.fieldSizes);var C=null},16391:(j,L,n)=>{n.d(L,{A:()=>E});const E=A=>A["content-manager_editViewLayoutManager"].currentLayout},27009:(j,L,n)=>{n.d(L,{A:()=>f});const f={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},7706:(j,L,n)=>{n.d(L,{A:()=>E});const E=A=>`content-manager.${A}`},98342:(j,L,n)=>{n.d(L,{ll:()=>Y.A,Sq:()=>v,oE:()=>F,tE:()=>M,IL:()=>U,Mq:()=>fe,vW:()=>q,BO:()=>I,MO:()=>ee,CU:()=>te,gT:()=>$.A,wX:()=>le,hi:()=>ue});var f=n(88055),E=n.n(f);const v=(r,u,a)=>{if(Array.isArray(r)&&u>=0&&a>=0&&u<=r.length-1&&a<=r.length-1){const o=E()(r),d=o.splice(u,1);return o.splice(a,0,d[0]),o}return r},F=r=>{const{type:u}=r;return u==="relation"?!(r?.relationType??"").toLowerCase().includes("morph"):!["json","dynamiczone","richtext","password"].includes(u)&&!!u},R=(r,u)=>{typeof r=="function"?r(u):r!=null&&(r.current=u)},M=(...r)=>u=>r.forEach(a=>R(a,u));var C=n(58156),h=n.n(C);const P=(r,u)=>Object.keys(r).reduce((a,o)=>{const d=h()(r,[o],{}),{default:g,component:l,type:e,required:s,min:t,repeatable:i}=d;if(g!==void 0&&(a[o]=g),e==="component"){const m=u?.[l]?.attributes??{},c=P(m,u);if(s===!0&&(a[o]=i===!0?[]:c),t&&i===!0&&s){a[o]=[];for(let p=0;p<t;p+=1)a[o].push(c)}}return e==="dynamiczone"&&s===!0&&(a[o]=[]),a},{}),U=P;var B=n(90179),z=n.n(B);const q=({layouts:r,metadatas:u,...a})=>{const o=r.list.map(l=>l.name?l.name:l),d=Object.keys(u).reduce((l,e)=>{const s=h()(u,[e],{});let t=s.edit;return t.mainField&&(t={...t,mainField:s.edit.mainField.name}),{...l,[e]:{edit:t,list:z()(s.list,["mainField"])}}},{}),g=r.edit.map(l=>l.map(({name:e,size:s})=>({name:e,size:s})));return{...a,layouts:{edit:g,list:o},metadatas:d}},W=(r,u)=>r.map(a=>({...a,subject:u})),I=r=>{const u={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(u).reduce((a,o)=>(a[o]=W(u[o],r),a),{})};var _=n(11741),Q=n.n(_);const ee=r=>r.split(".").filter(u=>Q()(parseInt(u,10))),te=r=>{if(r.length===0)return-1;const u=Math.max.apply(Math,r.map(a=>a.__temp_key__??0));return Number.isNaN(u)?-1:u};var $=n(7706),Y=n(27009),Z=n(55364),ne=n.n(Z),ae=n(63560),G=n.n(ae);const le=(r,u,a)=>{const o=e=>u.find(s=>s.uid===e),d=Object.assign({},r),g=r[a].uid,l=o(g);return G()(d,[a],ne()({},l,r[a])),Object.keys(r.components).forEach(e=>{const s=o(e);G()(d,["components",e],{...r.components[e],...s})}),d};var T=n(78320);const ue=(r,u,a)=>{const o=(d,g)=>Object.keys(d).reduce((l,e)=>{const s=(0,T.Pw)(g,e),t=h()(d,e),i=(0,T.uq)(g,[e,"component"]),m=(0,T.uq)(g,[e,"repeatable"]);return s==="dynamiczone"?(l[e]=t.map(c=>o(c,a[c.__component])),l):s==="component"?(m?l[e]=t&&t.map(c=>o(c,a[i])):l[e]=t&&o(t,a[i]),l):(s!=="password"&&(l[e]=t),l)},{});return o(r,u)};var pe=n(53812),ce=n.n(pe),he=n(62193),w=n.n(he),Te=n(99374),X=n.n(Te),D=n(20627),se=n(81748);D.Zg(D.gl,"defined",function(){return this.test("defined",T.iW.required,r=>r!==void 0)}),D.Zg(D.YO,"notEmptyMin",function(r){return this.test("notEmptyMin",T.iW.min,u=>w()(u)?!0:u.length>=r)}),D.Zg(D.Yj,"isInferior",function(r,u){return this.test("isInferior",r,function(a){return!a||Number.isNaN(X()(a))?!0:X()(u)>=X()(a)})}),D.Zg(D.Yj,"isSuperior",function(r,u){return this.test("isSuperior",r,function(a){return!a||Number.isNaN(X()(a))?!0:X()(a)>=X()(u)})});const de=r=>h()(r,["attributes"],{}),H=(r,{components:u},a={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1})=>{const o=de(r);return D.Ik().shape(Object.keys(o).reduce((d,g)=>{const l=o[g];if(l.type!=="relation"&&l.type!=="component"&&l.type!=="dynamiczone"){const e=me(l.type,l,a);d[g]=e}if(l.type==="relation"&&(d[g]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(l.relationType)?D.Ik().nullable():D.YO().nullable()),l.type==="component"){const e=H(u[l.component],{components:u},{...a,isFromComponent:!0});if(l.repeatable===!0){const{min:t,max:i,required:m}=l;let c=D.RZ(p=>{let y=D.YO().of(e);return t?m?y=y.min(t,T.iW.min):m!==!0&&w()(p)?y=y.nullable():y=y.min(t,T.iW.min):m&&!a.isDraft&&(y=y.min(1,T.iW.required)),i&&(y=y.max(i,T.iW.max)),y});return d[g]=c,d}const s=D.RZ(t=>t!==void 0?l.required===!0&&!a.isDraft?e.defined():e.nullable():l.required===!0?D.Ik().defined():D.Ik().nullable());return d[g]=s,d}if(l.type==="dynamiczone"){let e=D.YO().of(D.RZ(({__component:i})=>H(u[i],{components:u},{...a,isFromComponent:!0})));const{max:s,min:t}=l;t?l.required?e=e.test("min",T.iW.min,i=>a.isCreatingEntry?i&&i.length>=t:i===void 0?!0:i!==null&&i.length>=t).test("required",T.iW.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null):e=e.notEmptyMin(t):l.required&&!a.isDraft&&(e=e.test("required",T.iW.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null)),s&&(e=e.max(s,T.iW.max)),d[g]=e}return d},{}))},me=(r,u,a)=>{let o=D.gl();return["string","uid","text","richtext","email","password","enumeration"].includes(r)&&(o=D.Yj()),r==="json"&&(o=D.gl(T.iW.json).test("isJSON",T.iW.json,d=>{if(!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",T.iW.required,d=>!(u.required&&(!d||!d.length)))),r==="email"&&(o=o.email(T.iW.email)),["number","integer","float","decimal"].includes(r)&&(o=D.ai().transform(d=>Q()(d)?void 0:d).typeError()),r==="biginteger"&&(o=D.Yj().matches(/^-?\d*$/)),["date","datetime"].includes(r)&&(o=D.p6()),Object.keys(u).forEach(d=>{const g=u[d];if(g||!ce()(g)&&Number.isInteger(Math.floor(g))||g===0)switch(d){case"required":{a.isDraft||(r==="password"&&a.isCreatingEntry&&(o=o.required(T.iW.required)),r!=="password"&&(a.isCreatingEntry?o=o.required(T.iW.required):o=o.test("required",T.iW.required,l=>l===void 0&&!a.isFromComponent?!0:(0,se.A)(r)?l===0?!0:!!l:r==="boolean"?l!=null:r==="date"||r==="datetime"?typeof l=="string"?!w()(l):!w()(l?.toString()):!w()(l))));break}case"max":{r==="biginteger"?o=o.isInferior(T.iW.max,g):o=o.max(g,T.iW.max);break}case"maxLength":o=o.max(g,T.iW.maxLength);break;case"min":{r==="biginteger"?o=o.isSuperior(T.iW.min,g):o=o.min(g,T.iW.min);break}case"minLength":{a.isDraft||(o=o.min(g,T.iW.minLength));break}case"regex":o=o.matches(new RegExp(g),{message:T.iW.regex,excludeEmptyString:!u.required});break;case"lowercase":["text","textarea","email","string"].includes(r)&&(o=o.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(r)&&(o=o.strict().uppercase());break;case"positive":(0,se.A)(r)&&(o=o.positive());break;case"negative":(0,se.A)(r)&&(o=o.negative());break;default:o=o.nullable()}}),o},fe=H},81748:(j,L,n)=>{n.d(L,{A:()=>f});function f(E){return["integer","biginteger","decimal","float","number"].includes(E)}}}]);
