"use strict";(self.webpackChunkserver=self.webpackChunkserver||[]).push([[3275],{18492:(G,y,e)=>{e.r(y),e.d(y,{AuthenticatedApp:()=>xt});var t=e(96540),s=e(78320),A=e(75942),f=e(99589);const O={rE:"4.12.6"};var L=e(33878),D=e(98016),h=e(91616),E=e(34297),S=e(78897),I=e(69733),r=e(56347),tt=e(11744),et=e(86352),H=e(97939),nt=e(3115),at=e(52699),st=e(53412),z=e(26332),V=e(47505),ot=e(17495),lt=e(28007),rt=e(79419),it=e(33566),ct=e(52989),dt=e(5556),T=e.n(dt),mt=e(6442),R=e(54625),J=e(40948);const ut=(0,J.Ay)(h.a)`
  width: ${150/16}rem;
  position: absolute;
  bottom: ${({theme:n})=>n.spaces[9]};
  left: ${({theme:n})=>n.spaces[5]};
`,Q=(0,J.Ay)(R.k2)`
  display: flex;
  justify-content: space-between;
  align-items: center;
  text-decoration: none;
  padding: ${({theme:n})=>`${n.spaces[2]} ${n.spaces[4]}`};
  border-radius: ${({theme:n})=>n.spaces[1]};

  &:hover {
    background: ${({theme:n,logout:l})=>l?n.colors.danger100:n.colors.primary100};
    text-decoration: none;
  }

  svg {
    path {
      fill: ${({theme:n})=>n.colors.danger600};
    }
  }
`,X=({generalSectionLinks:n,pluginsSectionLinks:l})=>{const i=(0,t.useRef)(),[m,d]=(0,t.useState)(!1),{logos:{menu:u}}=(0,L.Bp)(),[g,P]=(0,s.ud)("navbar-condensed",!1),{userDisplayName:C}=(0,s.Xe)(),{formatMessage:o}=(0,mt.A)(),{trackUsage:p}=(0,s.z1)(),{pathname:U}=(0,r.zy)(),N=(0,r.W6)(),{post:j}=(0,s.GD)(),x=C.split(" ").map(a=>a.substring(0,1)).join("").substring(0,2),M=()=>d(a=>!a),$=async()=>{await j("/admin/logout"),s.j2.clearAppStorage(),M(),N.push("/auth/login")},K=a=>{!a.currentTarget.contains(a.relatedTarget)&&a.relatedTarget?.parentElement?.id!=="main-nav-user-button"&&d(!1)},v=(a=null)=>{p("willNavigate",{from:U,to:a})},W=o({id:"app.components.LeftMenu.navbrand.title",defaultMessage:"Strapi Dashboard"});return t.createElement(nt.N,{condensed:g},t.createElement(at.T,{as:R.k2,workplace:o({id:"app.components.LeftMenu.navbrand.workplace",defaultMessage:"Workplace"}),title:W,icon:t.createElement("img",{src:u.custom||u.default,alt:o({id:"app.components.LeftMenu.logo.alt",defaultMessage:"Application logo"})})}),t.createElement(tt.c,null),t.createElement(st.I,null,t.createElement(z.k,{as:R.k2,to:"/content-manager",icon:t.createElement(it.A,null),onClick:()=>v("/content-manager")},o({id:"global.content-manager",defaultMessage:"Content manager"})),l.length>0?t.createElement(V.R,{label:o({id:"app.components.LeftMenu.plugins",defaultMessage:"Plugins"})},l.map(a=>{const c=a.icon;return t.createElement(z.k,{as:R.k2,to:a.to,key:a.to,icon:t.createElement(c,null),onClick:()=>v(a.to)},o(a.intlLabel))})):null,n.length>0?t.createElement(V.R,{label:o({id:"app.components.LeftMenu.general",defaultMessage:"General"})},n.map(a=>{const c=a.icon;return t.createElement(z.k,{as:R.k2,badgeContent:a.notificationsCount>0&&a.notificationsCount.toString()||void 0,to:a.to,key:a.to,icon:t.createElement(c,null),onClick:()=>v(a.to)},o(a.intlLabel))})):null),t.createElement(ot.L,null,t.createElement(lt.r,{id:"main-nav-user-button",ref:i,onClick:M,initials:x},C),m&&t.createElement(ut,{onBlur:K,padding:1,shadow:"tableShadow",background:"neutral0",hasRadius:!0},t.createElement(et.s,{onEscape:M},t.createElement(D.s,{direction:"column",alignItems:"stretch",gap:0},t.createElement(Q,{tabIndex:0,onClick:M,to:"/me"},t.createElement(H.o,null,o({id:"global.profile",defaultMessage:"Profile"}))),t.createElement(Q,{tabIndex:0,onClick:$,to:"/auth/login"},t.createElement(H.o,{textColor:"danger600"},o({id:"app.components.LeftMenu.logout",defaultMessage:"Logout"})),t.createElement(ct.A,null))))),t.createElement(rt.v,{onClick:()=>P(a=>!a)},o(g?{id:"app.components.LeftMenu.expand",defaultMessage:"Expand the navbar"}:{id:"app.components.LeftMenu.collapse",defaultMessage:"Collapse the navbar"}))))};X.propTypes={generalSectionLinks:T().array.isRequired,pluginsSectionLinks:T().array.isRequired};const gt=X;var pt=e(47779),ft=e(29503),ht=e(21428),Et=e(45901);const vt=t.lazy(()=>Promise.all([e.e(5102),e.e(6366),e.e(8772),e.e(4492)]).then(e.bind(e,24526)).then(n=>({default:n.ContentManger}))),yt=t.lazy(()=>e.e(9264).then(e.bind(e,26991)).then(n=>({default:n.GuidedTourModal}))),Pt=t.lazy(()=>e.e(7675).then(e.bind(e,83672)).then(n=>({default:n.HomePage}))),Ct=t.lazy(()=>e.e(2076).then(e.bind(e,13572)).then(n=>({default:n.PluginsPage}))),Mt=t.lazy(()=>e.e(9140).then(e.bind(e,8716))),At=t.lazy(()=>e.e(3340).then(e.bind(e,80377)).then(n=>({default:n.Onboarding}))),Lt=t.lazy(()=>e.e(7003).then(e.bind(e,40025)).then(n=>({default:n.ProfilePage}))),Y=t.lazy(()=>e.e(4981).then(e.bind(e,44823)).then(n=>({default:n.SettingsPage}))),St=()=>{const{isLoading:n,generalSectionLinks:l,pluginsSectionLinks:i}=(0,ft.A)(),{menu:m}=(0,s.vD)(),{showTutorials:d}=(0,pt.A)(),{trackUsage:u}=(0,s.z1)(),g=(0,I.wA)(),P=(0,I.d4)(o=>o.admin_app.status);t.useEffect(()=>{P==="init"&&(u("didAccessAuthenticatedAdministration"),g({type:Et.h$}))},[P,g,u]);const C=m.filter(o=>o.Component).map(({to:o,Component:p,exact:U})=>(0,ht.u)(p,o,U));return n?t.createElement(s.Bl,null):t.createElement(E.DndProvider,{backend:S.t2},t.createElement(D.s,{alignItems:"stretch"},t.createElement(gt,{generalSectionLinks:l,pluginsSectionLinks:i}),t.createElement(h.a,{flex:"1"},t.createElement(t.Suspense,{fallback:t.createElement(s.Bl,null)},t.createElement(r.dO,null,t.createElement(r.qh,{path:"/",component:Pt,exact:!0}),t.createElement(r.qh,{path:"/me",component:Lt,exact:!0}),t.createElement(r.qh,{path:"/content-manager",component:vt}),C,t.createElement(r.qh,{path:"/settings/:settingId",component:Y}),t.createElement(r.qh,{path:"/settings",component:Y,exact:!0}),t.createElement(r.qh,{path:"/marketplace",component:Mt}),t.createElement(r.qh,{path:"/list-plugins",component:Ct,exact:!0})))),t.createElement(yt,null),d&&t.createElement(At,null)))};var It=e(26123);const Tt={bufferToHex(n){return[...new Uint8Array(n)].map(l=>l.toString(16).padStart(2,"0")).join("")},async digestMessage(n){const l=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",l);return this.bufferToHex(i)}};async function Rt(n){return Tt.digestMessage(n.email)}var Z=e(57913);const Ut=()=>({type:Z.G}),Nt=n=>({type:Z.w,permissions:n}),b=({children:n,permissions:l,refetchPermissions:i})=>{const{allPermissions:m}=(0,I.d4)(u=>u.rbacProvider),d=(0,I.wA)();return(0,t.useEffect)(()=>(d(Nt(l)),()=>{d(Ut())}),[l,d]),m?t.createElement(s.$.Provider,{value:{allPermissions:m,refetchPermissions:i}},n):t.createElement(s.Bl,null)};b.propTypes={children:T().element.isRequired,permissions:T().array.isRequired,refetchPermissions:T().func.isRequired};const Dt=b,F=O.rE,k=(n,l)=>!(0,f.valid)(n)||!(0,f.valid)(l)?!1:(0,f.lt)(n,l),xt=()=>{const{setGuidedTourVisibility:n}=(0,s.Cx)(),l=(0,s.hN)(),i=s.j2.getUserInfo(),{get:m}=(0,s.ry)(),[d,u]=t.useState(i?.userName??(0,It.d)(i.firstname,i.lastname)),[g,P]=t.useState(null),{showReleaseNotification:C}=(0,L.Bp)(),{plugins:o={}}=(0,s.vD)(),[p,U]=t.useState(o),[{data:N,isLoading:j},{data:x},{data:M,isLoading:$,refetch:K},{data:v}]=(0,A.useQueries)([{queryKey:"information",async queryFn(){const{data:{data:a}}=await m("/admin/information");return a}},{queryKey:"strapi-release",async queryFn(){const a=await fetch("https://api.github.com/repos/strapi/strapi/releases/latest");if(!a.ok)throw new Error("Failed to fetch latest Strapi version.");const{tag_name:c}=await a.json();return c},enabled:C,initialData:F,onSuccess(a){k(F,a.tag_name)&&!JSON.parse(localStorage.getItem("STRAPI_UPDATE_NOTIF"))&&l({type:"info",message:{id:"notification.version.update.message"},link:{url:`https://github.com/strapi/strapi/releases/tag/${a.tag_name}`,label:{id:"global.see-more"}},blockTransition:!0,onClose:()=>localStorage.setItem("STRAPI_UPDATE_NOTIF",!0)})},retry:!1},{queryKey:["users","me","permissions"],async queryFn(){const{data:{data:a}}=await m("/admin/users/me/permissions");return a},initialData:[]},{queryKey:["users","me"],async queryFn(){const{data:{data:{roles:a}}}=await m("/admin/users/me");return a}}]);t.useEffect(()=>{v&&v.find(({code:c})=>c==="strapi-super-admin")&&N?.currentEnvironment==="development"&&n(!0)},[v,N,n]),t.useEffect(()=>{i&&(async c=>{const B=await Rt(c);P(B)})(i)},[i]);const W=Object.values(p).some(a=>a.isReady===!1);if(!d||!g||j||$||W){const a=Object.keys(p).reduce((c,B)=>{const w=p[B].initializer;if(w){const Bt=p[B].pluginId;c.push(t.createElement(w,{key:Bt,setPlugin:q=>{U(_=>({..._,[q]:{..._[q],isReady:!0}}))}}))}return c},[]);return t.createElement(t.Fragment,null,a,t.createElement(s.Bl,null))}return t.createElement(s.Bc,{...N,userId:g,latestStrapiReleaseTag:x,setUserDisplayName:u,shouldUpdateStrapi:k(F,x),userDisplayName:d},t.createElement(Dt,{permissions:M,refetchPermissions:K},t.createElement(St,null)))}},21428:(G,y,e)=>{e.d(y,{u:()=>D});var t=e(96540),s=e(78320),A=e(5556),f=e.n(A),O=e(56347);const L=({loadComponent:h})=>{const[E,S]=(0,t.useState)(null);return(0,t.useEffect)(()=>{(async()=>{try{const r=await h();S(()=>r.default)}catch(r){console.log(r)}})()},[h]),E?t.createElement(E,null):t.createElement(s.Bl,null)};L.propTypes={loadComponent:f().func.isRequired};const D=(h,E,S)=>t.createElement(O.qh,{render:()=>t.createElement(L,{loadComponent:h}),key:E,path:E,exact:S||!1})},26123:(G,y,e)=>{e.d(y,{d:()=>t});const t=(s,A="")=>[s,A].filter(f=>f).join(" ")}}]);
